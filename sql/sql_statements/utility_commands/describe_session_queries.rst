:orphan:

.. _describe_session_queries:

************************
DESCRIBE SESSION QUERIES
************************

The ``DESCRIBE SESSION QUERIES`` command outputs a list of queries per session, including queued queries.
A session is opened per connection or per Workbench tab.

.. note:: ``DESCRIBE`` commands use CPU resources to enhance usability by freeing up GPU resources, which are primarily dedicated Workers which execute regular queries.

Syntax
======

.. code-block:: postgres

	DESC[RIBE] SESSION QUERIES [SESSION ID '<sessionId>' | ALL] 
		   [ TIMEFRAME FROM '<start_date_time>' TO '<end_date_time>' ]
		   [ DURATION FROM <min_duration_in_sec> TO <max_duration_in_sec> ]
		   [ USERNAME IN ( <username1>,..., <usernameN>) ] 
		   [ STATUS IN ( <status1>,..., <statusN>) ]
		   [ QUERYCATEGORY IN ( <category1>,..., <categoryN>) ]
		   [ POOL IN ( "<pool1>",..., "<poolN>") ]
		   [ LIMIT <results_limit> ]

Parameters
==========

.. list-table:: 
   :widths: auto
   :header-rows: 1
   
   * - Parameter
     - Data Type
     - Description
   * - ``SESSION ID``
     - :ref:`STRING literal<literals>`	
     - The session ID of the query. If not specified the current session ID is provided
   * - ``ALL``
     -  
     - Specifies that the operation should return results from all sessions. For users with ``SUPERUSER`` privileges, the results will include sessions across all users. However, if the user does not possess ``SUPERUSER`` privileges, the results will be limited to sessions associated with the current user.
   * - ``TIMEFRAME``
     -  DATETIME
     - A filter that allows you to specify a time range between two dates
   * - ``DURATION``
     -  INTEGER
     - A filter that allows you to get results of queiries with duration between spccified ``FROM`` (min) and ``TO`` (max) in seconds
   * - ``USERNAME IN``
     - ``TEXT``
     - Optional parameter for specifying usernames filter, values should be comma separated
   * - ``STATUS IN``
     -  ENUM
     - A filter that allows you to specify a subset of statuses from the following closed list:
	   * ``QUEUED``
	   * ``EXECUTING``
	   * ``EXECUTION_SUCCEED``
	   * ``EXECUTION_FAILED``
	   * ``CLOSED``
	   * ``COMPILATION_FAILED``
	   * ``ABORTED``
	   * ``FETCHING_RESULTS``
	   * ``COMPILING``
	   * ``COMPLETE``
   * - ``QUERYCATEGORY IN``
     - ``ENUM``
     - Optional parameter for specifying query categories filter, values should be comma separated.
	 
       Possible values include:
	    * ``ALTER``
		* ``TRUNCATE``
		* ``DROP``
		* ``PARAMETERIZED_INSERT``
		* ``USE``
		* ``AUDITLOG``
		* ``SET``
		* ``ABORT``
		* ``ACCESS_CONTROL``
		* ``STATISTICS``
		* ``INSERT``
		* ``SELECT``
		* ``DELETE``
		* ``UPDATE``
		* ``COPY_FROM``
		* ``COPY_TO``
		* ``DDL``
		* ``EXPORT``
		* ``DESCRIBE``
		* ``UNKNOWN``
   * - ``POOL IN``
     - ``TEXT``
     - Optional parameter for specifying resource pools filter, values should be comma separated
   * - ``LIMIT``
     - ``TEXT``
     - Optional parameter for specifying the number of results to be returned - default number is 200 rows, maximum is 4000 rows 
	 
Output
======

.. list-table:: 
   :widths: auto
   :header-rows: 1
   
   * - Parameter
     - Description
     - Type
   * - ``query_id``
     - ``TEXT``
     - Displays the query ID
   * - ``query_status``
     - ``TEXT``
     - Displays the query status
   * - ``query_type``
     - ``TEXT``
     - Displays the query type
   * - ``sql_text``
     - ``TEXT``
     - Displays the defined SQL text from the specified query
   * - ``role``
     - ``TEXT``
     - The role who executed the query	 
   * - ``session_id``
     - ``TEXT``
     - Displays the session ID
   * - ``start_time``
     - ``DATETIME``
     - Displays query execution date and time
   * - ``end_time``
     - ``DATETIME``
     - Displays query end date and time	 
   * - ``duration``
     - ``INTEGER``
     - Query duration time (milliseconds)
   * - ``time_in_queue``
     - ``INTEGER``
     - Query time in queue (milliseconds)
   * - ``compilation_time``
     - ``INTEGER``
     - Query compilation time (milliseconds)
   * - ``execution_time``
     - ``INTEGER``    
     - The execution time (milliseconds)
   * - ``total_compute_time``
     - ``INTEGER``	 
     - The total compute time is the period when the system is actively working, measured in milliseconds. If multiple workers are handling a query, the compute time might be longer than the time it takes to execute the query
   * - ``rows_read``
     - ``INTEGER``	
     - The number of rows read by the query	 
   * - ``rows produced``
     - ``INTEGER`` 
     - The number of rows returned by the query 
   * - ``data produced``
     - ``INTEGER``	 
     - The data size produced by the query (MegaBytes)
   * - ``data_read_compressed``
     - ``INTEGER`` 
     - The size of compressed read data (MegaBytes)
   * - ``data_read_uncompressed``
     - ``INTEGER``	 
     - The size of uncompressed read data (MegaBytes)
   * - ``client_info``
     - ``TEXT``
     - Displays information about the client driver type and version
   * - ``query_error``
     - ``TEXT``
     - The reason for query failure
   * - ``pool_name``
     - ``TEXT``	 
     - The resource pool used for executing the statement

Examples
========

.. code-block:: postgres

	DESCRIBE SESSION QUERIES SESSION ID  '683256f5-66b7-4d8c-b1a2-456dddcb6dee';

Output:

.. code-block:: none

	+--------+------------+----------+-----------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+--------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|query_id|query_status|query_type|sql_text                                             |role                 |session_id                          |start_time         |end_time           |duration|time_in_queue|compilation_time|execution_time|total_compute_time                                      |rows_read|rows produced|data produced|data_read_compressed|data_read_uncompressed|client_info   |query_error|pool_name|
	+--------+------------+----------+-----------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+--------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|6       |COMPLETE    |SELECT    |SELECT * FROM MyTable ORDER BY salary DESC LIMIT 5   |taliar@sqreamtech.com|683256f5-66b7-4d8c-b1a2-456dddcb6dee|2024-01-11T10:47:53|2024-01-11T10:47:55|2137    |0            |139             |1673          |0.56312761833333324634764949223608709871768951416015625 |50       |5            |245          |1624                |                      |SQream Node.js|           |sqream   |
	+--------+------------+----------+-----------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+--------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|5       |COMPLETE    |UPDATE    |UPDATE MyTable SET salary = 55000 WHERE name = 'John'|taliar@sqreamtech.com|683256f5-66b7-4d8c-b1a2-456dddcb6dee|2024-01-11T10:47:49|2024-01-11T10:47:51|1958    |0            |258             |789           |0.2553759140000000371628630091436207294464111328125     |50       |0            |0            |874                 |                      |SQream Node.js|           |sqream   |
	+--------+------------+----------+-----------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+--------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|4       |COMPLETE    |SELECT    |SELECT * FROM MyTable ORDER BY age DESC LIMIT 10000  |taliar@sqreamtech.com|683256f5-66b7-4d8c-b1a2-456dddcb6dee|2024-01-11T10:47:46|2024-01-11T10:47:49|2417    |0            |114             |1727          |0.57934194233333347057168793980963528156280517578125    |50       |50           |1720         |1624                |                      |SQream Node.js|           |sqream   |
	+--------+------------+----------+-----------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+--------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|3       |COMPLETE    |SELECT    |select 1 LIMIT 10000                                 |taliar@sqreamtech.com|683256f5-66b7-4d8c-b1a2-456dddcb6dee|2024-01-11T10:47:44|2024-01-11T10:47:45|1373    |0            |122             |708           |0.33468688299999993507327644692850299179553985595703125 |0        |1            |65           |0                   |                      |SQream Node.js|           |BI       |
	+--------+------------+----------+-----------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+--------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|2       |COMPLETE    |SELECT    |SELECT AVG(salary)  AS  average_salary  FROM  MyTable|taliar@sqreamtech.com|683256f5-66b7-4d8c-b1a2-456dddcb6dee|2024-01-11T10:47:04|2024-01-11T10:47:07|2738    |0            |476             |1764          |0.457902023999999963077556230928166769444942474365234375|50       |1            |72           |250                 |                      |SQream Node.js|           |BI       |
	|        |            |          |LIMIT 10000                                          |                     |                                    |                   |                   |        |             |                |              |                                                        |         |             |             |                    |                      |              |           |         |
	+--------+------------+----------+-----------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+--------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|1       |COMPLETE    |SELECT    |select * from mytable LIMIT 10000                    |taliar@sqreamtech.com|683256f5-66b7-4d8c-b1a2-456dddcb6dee|2024-01-11T10:46:56|2024-01-11T10:46:58|2481    |0            |202             |1694          |0.651208106333333258675111210322938859462738037109375   |50       |50           |1720         |1624                |                      |SQream Node.js|           |sqream   |
	+--------+------------+----------+-----------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+--------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+

.. code-block:: postgres

	DESC SESSION QUERIES TIMEFRAME from '2024-11-13 09:00:00' to '2024-11-15 09:00:00';

Output:

.. code-block:: none

	+--------+------------+----------------+------------------------------------------------------------------------------------------+------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+------------------+---------+-------------+-------------+--------------------+----------------------+-------------------+-----------+---------+
	|query_id|query_status|query_type      |sql_text                                                                                  |role  |session_id                          |start_time         |end_time           |duration|time_in_queue|compilation_time|execution_time|total_compute_time|rows_read|rows produced|data produced|data_read_compressed|data_read_uncompressed|client_info        |query_error|pool_name|
	+--------+------------+----------------+------------------------------------------------------------------------------------------+------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+------------------+---------+-------------+-------------+--------------------+----------------------+-------------------+-----------+---------+
	|4       |COMPILING   |DESCRIBE_COMMAND|DESCRIBE SESSION QUERIES TIMEFRAME from '2024-11-13 09:00:00' to '2024-11-15 09:00:00'    |sqream|ee22bb51-9d1d-4259-a87f-1031a8d0da00|2024-11-14T15:17:15|null               |        |             |0               |              |null              |         |             |             |                    |                      |SQream JDBC v0.1.75|           |sqream   |
	+--------+------------+----------------+------------------------------------------------------------------------------------------+------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+------------------+---------+-------------+-------------+--------------------+----------------------+-------------------+-----------+---------+
	|3       |COMPLETE    |DESCRIBE        |DESCRIBE SESSION QUERIES ALL TIMEFRAME from '2024-11-13 09:00:00' to '2024-11-15 09:00:00'|sqream|ee22bb51-9d1d-4259-a87f-1031a8d0da00|2024-11-14T15:14:44|2024-11-14T15:14:45|1341    |0            |47              |0             |0                 |         |             |68192        |                    |                      |SQream JDBC v0.1.75|           |sqream   |
	+--------+------------+----------------+------------------------------------------------------------------------------------------+------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+------------------+---------+-------------+-------------+--------------------+----------------------+-------------------+-----------+---------+
	|2       |COMPLETE    |DESCRIBE        |DESCRIBE SESSION QUERIES TIMEFRAME from '2024-11-13 09:00:00' to '2024-11-15 09:00:00'    |sqream|ee22bb51-9d1d-4259-a87f-1031a8d0da00|2024-11-14T15:14:21|2024-11-14T15:14:22|1029    |0            |43              |0             |0                 |         |             |804          |                    |                      |SQream JDBC v0.1.75|           |sqream   |
	+--------+------------+----------------+------------------------------------------------------------------------------------------+------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+------------------+---------+-------------+-------------+--------------------+----------------------+-------------------+-----------+---------+
	|1       |COMPLETE    |DESCRIBE        |DESC SESSION QUERIES ALL                                                                  |sqream|ee22bb51-9d1d-4259-a87f-1031a8d0da00|2024-11-14T15:14:06|2024-11-14T15:14:08|1417    |0            |44              |0             |0                 |         |             |68168        |                    |                      |SQream JDBC v0.1.75|           |sqream   |
	+--------+------------+----------------+------------------------------------------------------------------------------------------+------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+------------------+---------+-------------+-------------+--------------------+----------------------+-------------------+-----------+---------+


.. code-block:: postgres

	DESCRIBE SESSION QUERIES ALL USERNAME in ("nillyz@sqreamtech.com ", "shaharf@sqreamtech.com") DURATION from 2500 to 5000;

Output:

.. code-block:: none

	+--------+----------------+----------+-----------------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+---------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|query_id|query_status    |query_type|sql_text                                                   |role                 |session_id                          |start_time         |end_time           |duration|time_in_queue|compilation_time|execution_time|total_compute_time                                       |rows_read|rows produced|data produced|data_read_compressed|data_read_uncompressed|client_info   |query_error|pool_name|
	+--------+----------------+----------+-----------------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+---------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|4       |COMPLETE        |DELETE    |delete from t where xint = array[2,3]                      |nillyz@sqreamtech.com|a3ebdec8-0f4b-4882-b79a-747e6f7d1ef4|2024-10-10T05:10:46|2024-10-10T05:10:49|2956    |0            |889             |1883          |0.0670755620000000052360888957991846837103366851806640625|5        |0            |0            |78                  |                      |SQream Node.js|           |sqream   |
	+--------+----------------+----------+-----------------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+---------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|1       |COMPLETE        |SELECT    |select 1¶LIMIT 10000                                       |nillyz@sqreamtech.com|a3ebdec8-0f4b-4882-b79a-747e6f7d1ef4|2024-10-10T05:02:55|2024-10-10T05:03   |4958    |0            |2360            |1840          |0.250656471000000047322231466750963591039180755615234375 |0        |1            |65           |0                   |                      |SQream Node.js|           |sqream   |
	+--------+----------------+----------+-----------------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+---------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|1       |COMPLETE        |SELECT    |select 1¶LIMIT 10000                                       |nillyz@sqreamtech.com|e0671eca-24b5-457e-a8c5-69c705ec1187|2024-10-09T12:09:31|2024-10-09T12:09:36|4367    |0            |2427            |1359          |1.002336466999999675664412279729731380939483642578125    |0        |1            |65           |0                   |                      |SQream Node.js|           |sqream   |
	+--------+----------------+----------+-----------------------------------------------------------+---------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+---------------------------------------------------------+---------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+

.. code-block:: postgres

	DESCRIBE SESSION QUERIES ALL STATUS in (COMPLETE) QUERYCATEGORY IN (SELECT, USE, DDL) LIMIT 25;

Output:

.. code-block:: none

	+--------+------------+----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+-------------------------------------------------------+----------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|query_id|query_status|query_type|sql_text                                                                                                                                                                                                                                                       |role                  |session_id                          |start_time         |end_time           |duration|time_in_queue|compilation_time|execution_time|total_compute_time                                     |rows_read |rows produced|data produced|data_read_compressed|data_read_uncompressed|client_info   |query_error|pool_name|
	+--------+------------+----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+-------------------------------------------------------+----------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|12      |COMPLETE    |USE       |USE POOL ds_pool                                                                                                                                                                                                                                               |shaharf@sqreamtech.com|bd8a4015-d53f-4b2e-84f5-6fde24c53798|2024-11-14T12:32:10|2024-11-14T12:32:10|275     |0            |242             |0             |0                                                      |          |             |0            |                    |                      |SQream Node.js|           |sqream   |
	+--------+------------+----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+-------------------------------------------------------+----------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|1       |COMPLETE    |SELECT    |SELECT 2¶LIMIT 10000                                                                                                                                                                                                                                           |roys@sqreamtech.com   |82e609e9-ab53-4e71-aee3-ca35e89ed7f8|2024-11-14T12:00:34|2024-11-14T12:00:38|3430    |0            |2331            |987           |0.34308284266666666528777795974747277796268463134765625|0         |1            |65           |0                   |                      |SQream Node.js|           |sqream   |
	+--------+------------+----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+-------------------------------------------------------+----------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|28      |COMPLETE    |SELECT    |SELECT * from cross_price_elasticity_table¶LIMIT 10000                                                                                                                                                                                                         |roys@sqreamtech.com   |a57d31db-0efe-411f-9bec-0683e0b61dc5|2024-11-13T09:16:52|2024-11-13T09:16:53|1472    |0            |347             |1052          |0.2724187909999999934740344542660750448703765869140625 |11        |11           |270          |198                 |                      |SQream Node.js|           |sqream   |
	+--------+------------+----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+-------------------------------------------------------+----------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|27      |COMPLETE    |DDL       |CREATE or replace table cross_price_elasticity_table AS¶SELECT ws_item_sk AS ws_item_sk,¶       max(cross_price_elasticity) AS cross_price_elasticity¶FROM¶  (WITH temp_table as¶     (SELECT TOP 50 i_item_sk,¶                 i_wholesale_cost imp_sk,¶     |roys@sqreamtech.com   |a57d31db-0efe-411f-9bec-0683e0b61dc5|2024-11-13T09:14:28|2024-11-13T09:15:32|64096   |0            |1556            |62420         |203.912628211250108734020614065229892730712890625      |2456080906|0            |0            |13044186276         |                      |SQream Node.js|           |sqream   |
	+--------+------------+----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+-------------------------------------------------------+----------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|26      |COMPLETE    |SELECT    |SELECT ws_item_sk AS ws_item_sk,¶       max(cross_price_elasticity) AS cross_price_elasticity¶FROM¶  (WITH temp_table as¶     (SELECT TOP 50 i_item_sk,¶                 i_wholesale_cost imp_sk,¶                 (imp_competitor_price - i_current_price) / i|roys@sqreamtech.com   |a57d31db-0efe-411f-9bec-0683e0b61dc5|2024-11-13T09:12:52|2024-11-13T09:13:57|65732   |0            |3296            |62253         |172.562678668749867938458919525146484375               |2456080906|11           |270          |13044186276         |                      |SQream Node.js|           |sqream   |
	+--------+------------+----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+-------------------------------------------------------+----------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+
	|25      |COMPLETE    |DDL       |create or replace foreign table web_site¶(¶  web_site_sk bigint not null,¶  web_site_id text not null,¶  web_rec_start_date text not null,¶  web_rec_end_date text null,¶  web_name text not null,¶  web_open_date_sk bigint not null,¶  web_close_date_sk bigi|roys@sqreamtech.com   |a57d31db-0efe-411f-9bec-0683e0b61dc5|2024-11-13T09:10:22|2024-11-13T09:10:22|403     |0            |140             |200           |0                                                      |          |             |0            |                    |                      |SQream Node.js|           |sqream   |
	+--------+------------+----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+------------------------------------+-------------------+-------------------+--------+-------------+----------------+--------------+-------------------------------------------------------+----------+-------------+-------------+--------------------+----------------------+--------------+-----------+---------+


Permissions
===========

This command requires a ``CONNECT`` permission.