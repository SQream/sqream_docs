<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Connecting to SQream Using Python (pysqream) &mdash; SQream Blue 1.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #133148" >
            <a href="../../../index.html">
            <img src="../../../_static/SQream_logo_without background-15.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../login_and_connectors.html">Login and Connectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cost_management.html">Cost Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../performing_basic_sqream_operations.html">Performing Basic SQream Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../running_the_sqream_sql_client.html">Running the SQream SQL Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../creating_your_first_table.html">Creating Your First Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../listing_tables.html">Listing Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../inserting_rows.html">Inserting Rows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../running_queries.html">Running Queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../saving_query_results_to_a_csv_or_psv_file.html">Saving Query Results to a CSV or PSV File</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/blue_console.html">BLUE Console</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/sql/index.html">SQL Statements and Syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/sql/sql_syntax/index.html">SQL Syntax Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/sql/sql_statements/index.html">SQL Statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/sql/sql_functions/index.html">SQL Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/sql/sql_functions/scalar_functions/index.html">Built-In Scalar Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/sql/sql_functions/user_defined_functions/index.html">User-Defined Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/sql/sql_functions/aggregate_functions/index.html">Aggregate Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/sql/sql_functions/window_functions/index.html">Window Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/sql_feature_support.html">SQL Feature Checklist</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_type_guides/index.html">Data Type Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../data_type_guides/converting_and_casting_types.html">Converting and Casting Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_type_guides/supported_data_types.html">Supported Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_type_guides/supported_casts.html">Supported Casts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../data_type_guides/sql_data_types_numeric.html">Numeric</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../data_type_guides/sql_data_types_boolean.html">Boolean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../data_type_guides/sql_data_types_integer.html">Integer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../data_type_guides/sql_data_types_floating_point.html">Floating Point</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../data_type_guides/sql_data_types_string.html">String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../data_type_guides/sql_data_types_date.html">Date</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../file_types/index.html">File Types</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../file_types/file_types_overview.html">File Types Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../file_types/avro.html">Avro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../file_types/csv.html">CSV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../file_types/parquet.html">Parquet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../file_types/orc.html">ORC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../file_types/json.html">JSON</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../feature_guides/index.html">Feature Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../feature_guides/python_functions.html">Python UDF (User-Defined Functions)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../feature_guides/concurrency_and_locks.html">Concurrency and Locks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../feature_guides/concurrency_and_scaling_in_sqream.html">Concurrency and Scaling in SQream DB</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../operational_guides/index.html">Operational Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../operational_guides/access_control.html">Access Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../operational_guides/access_control_overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../operational_guides/access_control_managing_roles.html">Managing Roles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../operational_guides/access_control_permissions.html">Permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../operational_guides/access_control_password_policy.html">Password Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../operational_guides/access_control_departmental_example.html">Departmental Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../operational_guides/audit_log_operation.html">Audit Log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operational_guides/exporting_data.html">Exporting Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operational_guides/monitoring_query_performance.html">Monitoring Query Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operational_guides/security.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operational_guides/seeing_system_objects_as_ddl.html">Seeing System Objects as DDL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../operational_guides/optimization_best_practices.html">Optimization and Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration_guides/index.html">Configuration Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../configuration_guides/bucket/bucket_integration.html">Bucket Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../configuration_guides/spooling.html">Configuring the Spooling Feature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../configuration_guides/configuring_sqream.html">Configuring SQream</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../configuration_guides/configuration_flags.html">Configuration Flags</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../configuration_guides/admin_flags.html">Administration Flags</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../configuration_guides/admin_regular_flags.html">Regular Administration Flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../configuration_guides/admin_worker_flags.html">Worker Administration Flags</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../configuration_guides/generic_flags.html">Generic Flags</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../configuration_guides/generic_regular_flags.html">Regular Generic Flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../configuration_guides/generic_worker_flags.html">Worker Generic Flags</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../loading_and_unloading_data/index.html">Loading and Unloading Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshooting/index.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../troubleshooting/remedying_slow_queries.html">Remedying Slow Queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../troubleshooting/resolving_common_issues.html">Resolving Common Issues</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../troubleshooting/lock_related_issues.html">Lock Related Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../troubleshooting/information_for_support.html">Gathering Information for SQream Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #133148" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">SQream Blue</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Connecting to SQream Using Python (pysqream)</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="connecting-to-sqream-using-python-pysqream">
<span id="pysqream"></span><h1>Connecting to SQream Using Python (pysqream)<a class="headerlink" href="#connecting-to-sqream-using-python-pysqream" title="Permalink to this heading"></a></h1>
<p>The <strong>Python</strong> connector page describes the following:</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id7">Overview</a></p></li>
<li><p><a class="reference internal" href="#installing-the-python-connector" id="id8">Installing the Python Connector</a></p></li>
<li><p><a class="reference internal" href="#sqlalchemy-examples" id="id9">SQLAlchemy Examples</a></p></li>
<li><p><a class="reference internal" href="#api-examples" id="id10">API Examples</a></p></li>
</ul>
</div>
<section id="overview">
<h2><a class="toc-backref" href="#id7">Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>The SQream Python connector is a set of packages that allows Python programs to connect to SQream DB.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pysqream</span></code> is a pure Python connector. It can be installed with <code class="docutils literal notranslate"><span class="pre">pip</span></code> on any operating system, including Linux, Windows, and macOS.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pysqream-sqlalchemy</span></code> is a SQLAlchemy dialect for <code class="docutils literal notranslate"><span class="pre">pysqream</span></code></p></li>
</ul>
<p>The connector supports Python 3.6.5 and newer. The base <code class="docutils literal notranslate"><span class="pre">pysqream</span></code> package conforms to Python DB-API specifications <a class="reference external" href="https://www.python.org/dev/peps/pep-0249/">PEP-249</a>.</p>
</section>
<section id="installing-the-python-connector">
<h2><a class="toc-backref" href="#id8">Installing the Python Connector</a><a class="headerlink" href="#installing-the-python-connector" title="Permalink to this heading"></a></h2>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading"></a></h3>
<p>Installing the Python connector includes the following prerequisites:</p>
<div class="contents local topic" id="id1">
<ul class="simple">
<li><p><a class="reference internal" href="#python" id="id11">Python</a></p></li>
<li><p><a class="reference internal" href="#pip" id="id12">PIP</a></p></li>
<li><p><a class="reference internal" href="#openssl-for-linux" id="id13">OpenSSL for Linux</a></p></li>
</ul>
</div>
<section id="python">
<h4><a class="toc-backref" href="#id11">Python</a><a class="headerlink" href="#python" title="Permalink to this heading"></a></h4>
<p>The connector requires Python 3.6.5 or newer. To verify your version of Python:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python --version
<span class="go">Python 3.7.3</span>
</pre></div>
</div>
</section>
<section id="pip">
<h4><a class="toc-backref" href="#id12">PIP</a><a class="headerlink" href="#pip" title="Permalink to this heading"></a></h4>
<p>The Python connector is installed via <code class="docutils literal notranslate"><span class="pre">pip</span></code>, the Python package manager and installer.</p>
<p>We recommend upgrading to the latest version of <code class="docutils literal notranslate"><span class="pre">pip</span></code> before installing. To verify that you are on the latest version, run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python3 -m pip install --upgrade pip
<span class="go">Collecting pip</span>
<span class="go">   Downloading https://files.pythonhosted.org/packages/00/b6/9cfa56b4081ad13874b0c6f96af8ce16cfbc1cb06bedf8e9164ce5551ec1/pip-19.3.1-py2.py3-none-any.whl (1.4MB)</span>
<span class="go">     |████████████████████████████████| 1.4MB 1.6MB/s</span>
<span class="go">Installing collected packages: pip</span>
<span class="go">  Found existing installation: pip 19.1.1</span>
<span class="go">    Uninstalling pip-19.1.1:</span>
<span class="go">      Successfully uninstalled pip-19.1.1</span>
<span class="go">Successfully installed pip-19.3.1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>On macOS, you may want to use virtualenv to install Python and the connector, to ensure compatibility with the built-in Python environment</p></li>
<li><p>If you encounter an error including <code class="docutils literal notranslate"><span class="pre">SSLError</span></code> or <code class="docutils literal notranslate"><span class="pre">WARNING:</span> <span class="pre">pip</span> <span class="pre">is</span> <span class="pre">configured</span> <span class="pre">with</span> <span class="pre">locations</span> <span class="pre">that</span> <span class="pre">require</span> <span class="pre">TLS/SSL,</span> <span class="pre">however</span> <span class="pre">the</span> <span class="pre">ssl</span> <span class="pre">module</span> <span class="pre">in</span> <span class="pre">Python</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">available.</span></code> - please be sure to reinstall Python with SSL enabled, or use virtualenv or Anaconda.</p></li>
</ul>
</div>
</section>
<section id="openssl-for-linux">
<h4><a class="toc-backref" href="#id13">OpenSSL for Linux</a><a class="headerlink" href="#openssl-for-linux" title="Permalink to this heading"></a></h4>
<p>Some distributions of Python do not include OpenSSL. The Python connector relies on OpenSSL for secure connections to SQream DB.</p>
<ul>
<li><p>To install OpenSSL on RHEL/CentOS</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo yum install -y libffi-devel openssl-devel
</pre></div>
</div>
</li>
<li><p>To install OpenSSL on Ubuntu</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo apt-get install libssl-dev libffi-dev -y
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="installing-via-pip">
<h3>Installing via PIP<a class="headerlink" href="#installing-via-pip" title="Permalink to this heading"></a></h3>
<p>The Python connector is available via <a class="reference external" href="https://pypi.org/project/pysqream/">PyPi</a>.</p>
<p>Install the connector with <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip3 install pysqream pysqream-sqlalchemy
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pip3</span></code> will automatically install all necessary libraries and modules.</p>
</section>
<section id="upgrading-an-existing-installation">
<h3>Upgrading an Existing Installation<a class="headerlink" href="#upgrading-an-existing-installation" title="Permalink to this heading"></a></h3>
<p>The Python drivers are updated periodically. To upgrade an existing pysqream installation, use pip’s <code class="docutils literal notranslate"><span class="pre">-U</span></code> flag:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip3 install pysqream pysqream-sqlalchemy -U
</pre></div>
</div>
</section>
<section id="validating-your-installation">
<h3>Validating Your Installation<a class="headerlink" href="#validating-your-installation" title="Permalink to this heading"></a></h3>
<p>This section describes how to validate your installation.</p>
<p><strong>To validate your installation</strong>:</p>
<ol class="arabic simple">
<li><p>Create a file called <code class="docutils literal notranslate"><span class="pre">sample.py</span></code>, containing the following:</p></li>
</ol>
<ol class="arabic" start="2">
<li><p>Verify that the parameters in the connection have been replaced with your respective SQream installation parameters.</p>
<blockquote>
<div></div></blockquote>
</li>
<li><p>Run the sample file to verify that you can connect to SQream:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python sample.py
<span class="go">Version: v2020.1</span>
</pre></div>
</div>
<p>If the validation was successful, you can build an application using the SQream Python connector. If you receive a connection error, verify the following:</p>
<ul>
<li><p>You have access to a running SQream database.</p>
<blockquote>
<div></div></blockquote>
</li>
<li><p>The connection parameters are correct.</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section id="sqlalchemy-examples">
<h2><a class="toc-backref" href="#id9">SQLAlchemy Examples</a><a class="headerlink" href="#sqlalchemy-examples" title="Permalink to this heading"></a></h2>
<p>SQLAlchemy is an <a href="#id2"><span class="problematic" id="id3">**</span></a>Object-Relational Mapper (ORM) for Python. When you install the SQream dialect (<code class="docutils literal notranslate"><span class="pre">pysqream-sqlalchemy</span></code>) you can use frameworks such as Pandas, TensorFlow, and Alembic to query SQream directly.</p>
<p>This section includes the following examples:</p>
<div class="contents local topic" id="id4">
<ul class="simple">
<li><p><a class="reference internal" href="#standard-connection-example" id="id14">Standard Connection Example</a></p></li>
<li><p><a class="reference internal" href="#multi-cluster-connection-example" id="id15">Multi Cluster Connection Example</a></p></li>
<li><p><a class="reference internal" href="#pulling-a-table-into-pandas" id="id16">Pulling a Table into Pandas</a></p></li>
</ul>
</div>
<section id="standard-connection-example">
<h3><a class="toc-backref" href="#id14">Standard Connection Example</a><a class="headerlink" href="#standard-connection-example" title="Permalink to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlalchemy</span> <span class="k">as</span> <span class="nn">sa</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.engine.url</span> <span class="kn">import</span> <span class="n">URL</span>

<span class="n">engine_url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">(</span><span class="s1">&#39;sqream&#39;</span>
                          <span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;rhendricks&#39;</span>
                          <span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;secret_passwor&quot;</span>
                          <span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>
                          <span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span>
                          <span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;raviga&#39;</span>
                          <span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_ssl&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">engine_url</span><span class="p">)</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;create or replace table test (ints int, ints2 int)&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into test (ints,ints2) values (5,1), (6,2)&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;select * from test&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="multi-cluster-connection-example">
<h3><a class="toc-backref" href="#id15">Multi Cluster Connection Example</a><a class="headerlink" href="#multi-cluster-connection-example" title="Permalink to this heading"></a></h3>
<p>The following example is for using a ServerPicker:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlalchemy</span> <span class="k">as</span> <span class="nn">sa</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.engine.url</span> <span class="kn">import</span> <span class="n">URL</span>


<span class="n">engine_url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">(</span><span class="s1">&#39;sqream&#39;</span>
                          <span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;dor&#39;</span>
                          <span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;DorBerg123$&#39;</span>
                          <span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>
                          <span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3108</span>
                          <span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;pushlive&#39;</span><span class="p">)</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">engine_url</span><span class="p">,</span><span class="n">connect_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;clustered&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;create or replace table test100 (dor int);&quot;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into test100 values (5), (6);&#39;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;select * from test100&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="pulling-a-table-into-pandas">
<h3><a class="toc-backref" href="#id16">Pulling a Table into Pandas</a><a class="headerlink" href="#pulling-a-table-into-pandas" title="Permalink to this heading"></a></h3>
<p>The following example shows how to pull a table in Pandas. This examples uses the URL method to create the connection string:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlalchemy</span> <span class="k">as</span> <span class="nn">sa</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.engine.url</span> <span class="kn">import</span> <span class="n">URL</span>


<span class="n">engine_url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">(</span><span class="s1">&#39;sqream&#39;</span>
              <span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;rhendricks&#39;</span>
              <span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;secret_passwor&quot;</span>
              <span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>
              <span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span>
              <span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;raviga&#39;</span>
              <span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_ssl&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">engine_url</span><span class="p">)</span>

<span class="n">table_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="s2">&quot;select * from nba&quot;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="api-examples">
<h2><a class="toc-backref" href="#id10">API Examples</a><a class="headerlink" href="#api-examples" title="Permalink to this heading"></a></h2>
<p>This section includes the following examples:</p>
<div class="contents local topic" id="id5">
<ul class="simple">
<li><p><a class="reference internal" href="#using-the-cursor" id="id17">Using the Cursor</a></p></li>
<li><p><a class="reference internal" href="#reading-result-metadata" id="id18">Reading Result Metadata</a></p></li>
<li><p><a class="reference internal" href="#loading-data-into-a-table" id="id19">Loading Data into a Table</a></p></li>
<li><p><a class="reference internal" href="#using-sqlalchemy-orm-to-create-and-populate-tables" id="id20">Using SQLAlchemy ORM to Create and Populate Tables</a></p></li>
</ul>
</div>
<section id="using-the-cursor">
<h3><a class="toc-backref" href="#id17">Using the Cursor</a><a class="headerlink" href="#using-the-cursor" title="Permalink to this heading"></a></h3>
<p>The DB-API specification includes several methods for fetching results from the cursor. This sections shows an example using the <code class="docutils literal notranslate"><span class="pre">nba</span></code> table, which looks as follows:</p>
<table class="colwidths-auto docutils align-default" id="id6">
<caption><span class="caption-text">nba</span><a class="headerlink" href="#id6" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Team</p></th>
<th class="head"><p>Number</p></th>
<th class="head"><p>Position</p></th>
<th class="head"><p>Age</p></th>
<th class="head"><p>Height</p></th>
<th class="head"><p>Weight</p></th>
<th class="head"><p>College</p></th>
<th class="head"><p>Salary</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Avery Bradley</p></td>
<td><p>Boston Celtics</p></td>
<td><p>0.0</p></td>
<td><p>PG</p></td>
<td><p>25.0</p></td>
<td><p>6-2</p></td>
<td><p>180.0</p></td>
<td><p>Texas</p></td>
<td><p>7730337.0</p></td>
</tr>
<tr class="row-odd"><td><p>Jae Crowder</p></td>
<td><p>Boston Celtics</p></td>
<td><p>99.0</p></td>
<td><p>SF</p></td>
<td><p>25.0</p></td>
<td><p>6-6</p></td>
<td><p>235.0</p></td>
<td><p>Marquette</p></td>
<td><p>6796117.0</p></td>
</tr>
<tr class="row-even"><td><p>John Holland</p></td>
<td><p>Boston Celtics</p></td>
<td><p>30.0</p></td>
<td><p>SG</p></td>
<td><p>27.0</p></td>
<td><p>6-5</p></td>
<td><p>205.0</p></td>
<td><p>Boston University</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>R.J. Hunter</p></td>
<td><p>Boston Celtics</p></td>
<td><p>28.0</p></td>
<td><p>SG</p></td>
<td><p>22.0</p></td>
<td><p>6-5</p></td>
<td><p>185.0</p></td>
<td><p>Georgia State</p></td>
<td><p>1148640.0</p></td>
</tr>
<tr class="row-even"><td><p>Jonas Jerebko</p></td>
<td><p>Boston Celtics</p></td>
<td><p>8.0</p></td>
<td><p>PF</p></td>
<td><p>29.0</p></td>
<td><p>6-10</p></td>
<td><p>231.0</p></td>
<td></td>
<td><p>5000000.0</p></td>
</tr>
<tr class="row-odd"><td><p>Amir Johnson</p></td>
<td><p>Boston Celtics</p></td>
<td><p>90.0</p></td>
<td><p>PF</p></td>
<td><p>29.0</p></td>
<td><p>6-9</p></td>
<td><p>240.0</p></td>
<td></td>
<td><p>12000000.0</p></td>
</tr>
<tr class="row-even"><td><p>Jordan Mickey</p></td>
<td><p>Boston Celtics</p></td>
<td><p>55.0</p></td>
<td><p>PF</p></td>
<td><p>21.0</p></td>
<td><p>6-8</p></td>
<td><p>235.0</p></td>
<td><p>LSU</p></td>
<td><p>1170960.0</p></td>
</tr>
<tr class="row-odd"><td><p>Kelly Olynyk</p></td>
<td><p>Boston Celtics</p></td>
<td><p>41.0</p></td>
<td><p>C</p></td>
<td><p>25.0</p></td>
<td><p>7-0</p></td>
<td><p>238.0</p></td>
<td><p>Gonzaga</p></td>
<td><p>2165160.0</p></td>
</tr>
<tr class="row-even"><td><p>Terry Rozier</p></td>
<td><p>Boston Celtics</p></td>
<td><p>12.0</p></td>
<td><p>PG</p></td>
<td><p>22.0</p></td>
<td><p>6-2</p></td>
<td><p>190.0</p></td>
<td><p>Louisville</p></td>
<td><p>1824360.0</p></td>
</tr>
</tbody>
</table>
<p>As before, you must import the library and create a <code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection()</span></code>, followed by <code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code> on a simple <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span></code> query:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pysqream</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">pysqream</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3108</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;master&#39;</span>
                   <span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;rhendricks&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;Tr0ub4dor&amp;3&#39;</span>
                   <span class="p">,</span> <span class="n">clustered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="c1"># Create a new cursor</span>
<span class="c1"># The select statement:</span>
<span class="n">statement</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM nba&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
</pre></div>
</div>
<p>When the statement has finished executing, you have a <code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection</span></code> cursor object waiting. A cursor is iterable, meaning that it advances the cursor to the next row when fetched.</p>
<p>You can use <code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchone()</span></code> to fetch one record at a time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_row</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span> <span class="c1"># Fetch one row at a time (first row)</span>

<span class="n">second_row</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span> <span class="c1"># Fetch one row at a time (second row)</span>
</pre></div>
</div>
<p>To fetch several rows at a time, use <code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchmany()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># executing `fetchone` twice is equivalent to this form:</span>
<span class="n">third_and_fourth_rows</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>To fetch all rows at once, use <code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchall()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># To get all rows at once, use `fetchall`</span>
<span class="n">remaining_rows</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="c1"># Close the connection when done</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The following is an example of the contents of the row variables used in our examples:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">first_row</span><span class="p">)</span>
<span class="go">(&#39;Avery Bradley&#39;, &#39;Boston Celtics&#39;, 0, &#39;PG&#39;, 25, &#39;6-2&#39;, 180, &#39;Texas&#39;, 7730337)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">second_row</span><span class="p">)</span>
<span class="go">(&#39;Jae Crowder&#39;, &#39;Boston Celtics&#39;, 99, &#39;SF&#39;, 25, &#39;6-6&#39;, 235, &#39;Marquette&#39;, 6796117)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">third_and_fourth_rows</span><span class="p">)</span>
<span class="go">[(&#39;John Holland&#39;, &#39;Boston Celtics&#39;, 30, &#39;SG&#39;, 27, &#39;6-5&#39;, 205, &#39;Boston University&#39;, None), (&#39;R.J. Hunter&#39;, &#39;Boston Celtics&#39;, 28, &#39;SG&#39;, 22, &#39;6-5&#39;, 185, &#39;Georgia State&#39;, 1148640)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">remaining_rows</span><span class="p">)</span>
<span class="go">[(&#39;Jonas Jerebko&#39;, &#39;Boston Celtics&#39;, 8, &#39;PF&#39;, 29, &#39;6-10&#39;, 231, None, 5000000), (&#39;Amir Johnson&#39;, &#39;Boston Celtics&#39;, 90, &#39;PF&#39;, 29, &#39;6-9&#39;, 240, None, 12000000), (&#39;Jordan Mickey&#39;, &#39;Boston Celtics&#39;, 55, &#39;PF&#39;, 21, &#39;6-8&#39;, 235, &#39;LSU&#39;, 1170960), (&#39;Kelly Olynyk&#39;, &#39;Boston Celtics&#39;, 41, &#39;C&#39;, 25, &#39;7-0&#39;, 238, &#39;Gonzaga&#39;, 2165160),</span>
<span class="go">[...]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calling a fetch command after all rows have been fetched will return an empty array (<code class="docutils literal notranslate"><span class="pre">[]</span></code>).</p>
</div>
</section>
<section id="reading-result-metadata">
<h3><a class="toc-backref" href="#id18">Reading Result Metadata</a><a class="headerlink" href="#reading-result-metadata" title="Permalink to this heading"></a></h3>
<p>When you execute a statement, the connection object also contains metadata about the result set, such as <strong>column names</strong>, <strong>types</strong>, etc).</p>
<p>The metadata is stored in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.description</span></code> object of the cursor:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysqream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">pysqream</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3108</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;master&#39;</span>
<span class="gp">... </span>               <span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;rhendricks&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;Tr0ub4dor&amp;3&#39;</span>
<span class="gp">... </span>               <span class="p">,</span> <span class="n">clustered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">statement</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM nba&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>
<span class="go">&lt;pysqream.dbapi.Connection object at 0x000002EA952139B0&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
<span class="go">[(&#39;Name&#39;, &#39;STRING&#39;, 24, 24, None, None, True), (&#39;Team&#39;, &#39;STRING&#39;, 22, 22, None, None, True), (&#39;Number&#39;, &#39;NUMBER&#39;, 1, 1, None, None, True), (&#39;Position&#39;, &#39;STRING&#39;, 2, 2, None, None, True), (&#39;Age (as of 2018)&#39;, &#39;NUMBER&#39;, 1, 1, None, None, True), (&#39;Height&#39;, &#39;STRING&#39;, 4, 4, None, None, True), (&#39;Weight&#39;, &#39;NUMBER&#39;, 2, 2, None, None, True), (&#39;College&#39;, &#39;STRING&#39;, 21, 21, None, None, True), (&#39;Salary&#39;, &#39;NUMBER&#39;, 4, 4, None, None, True)]</span>
</pre></div>
</div>
<p>You can fetch a list of column names by iterating over the <code class="docutils literal notranslate"><span class="pre">description</span></code> list:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">description</span> <span class="p">]</span>
<span class="go">[&#39;Name&#39;, &#39;Team&#39;, &#39;Number&#39;, &#39;Position&#39;, &#39;Age (as of 2018)&#39;, &#39;Height&#39;, &#39;Weight&#39;, &#39;College&#39;, &#39;Salary&#39;]</span>
</pre></div>
</div>
</section>
<section id="loading-data-into-a-table">
<h3><a class="toc-backref" href="#id19">Loading Data into a Table</a><a class="headerlink" href="#loading-data-into-a-table" title="Permalink to this heading"></a></h3>
<p>This example shows how to load 10,000 rows of dummy data to an instance of SQream.</p>
<p><strong>To load data 10,000 rows of dummy data to an instance of SQream:</strong></p>
<ol class="arabic">
<li><p>Run the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pysqream</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">pysqream</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">3108</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;master&#39;</span>
                   <span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;rhendricks&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;Tr0ub4dor&amp;3&#39;</span>
                   <span class="p">,</span> <span class="n">clustered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                                           <span class="p">,</span> <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Create a table for loading:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">create</span> <span class="o">=</span> <span class="s1">&#39;create or replace table perf (b bool, t tinyint, sm smallint, i int, bi bigint, f real, d double, s varchar(12), ss text, dt date, dtt datetime)&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">create</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Load your data into table using the <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> command.</p>
<blockquote>
<div></div></blockquote>
</li>
<li><p>Create dummy data matching the table you created:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">84124234</span><span class="p">,</span> <span class="mf">3.141</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.3</span><span class="p">,</span> <span class="s2">&quot;Marty McFly&quot;</span> <span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;キウイは楽しい鳥です&quot;</span> <span class="p">,</span> <span class="n">date</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">1955</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">row_count</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">4</span>
</pre></div>
</div>
</li>
<li><p>Get a new cursor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">insert</span> <span class="o">=</span> <span class="s1">&#39;insert into perf values (?,?,?,?,?,?,?,?,?,?,?)&#39;</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">cur</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="n">insert</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span> <span class="o">*</span> <span class="n">row_count</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total insert time for </span><span class="si">{</span><span class="n">row_count</span><span class="si">}</span><span class="s2"> rows: </span><span class="si">{</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Close this cursor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Verify that the data was inserted correctly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;select count(*) from perf&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span> <span class="c1"># `fetchall` collects the entire data set</span>
<span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Count of inserted rows: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Close the cursor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Close the connection:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="using-sqlalchemy-orm-to-create-and-populate-tables">
<h3><a class="toc-backref" href="#id20">Using SQLAlchemy ORM to Create and Populate Tables</a><a class="headerlink" href="#using-sqlalchemy-orm-to-create-and-populate-tables" title="Permalink to this heading"></a></h3>
<p>This section shows how to use the ORM to create and populate tables from Python objects.</p>
<p><strong>To use SQLAlchemy ORM to create and populate tables:</strong></p>
<ol class="arabic">
<li><p>Run the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlalchemy</span> <span class="k">as</span> <span class="nn">sa</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.engine.url</span> <span class="kn">import</span> <span class="n">URL</span>


<span class="n">engine_url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">(</span><span class="s1">&#39;sqream&#39;</span>
              <span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;rhendricks&#39;</span>
              <span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;secret_passwor&quot;</span>
              <span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>
              <span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span>
              <span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;raviga&#39;</span>
              <span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_ssl&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">engine_url</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Build a metadata object and bind it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">MetaData</span><span class="p">()</span>
<span class="n">metadata</span><span class="o">.</span><span class="n">bind</span> <span class="o">=</span> <span class="n">engine</span>
</pre></div>
</div>
</li>
<li><p>Create a table in the local metadata:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">employees</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span>
<span class="s1">&#39;employees&#39;</span>
<span class="p">,</span> <span class="n">metadata</span>
<span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">Integer</span><span class="p">)</span>
<span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
<span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;lastname&#39;</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
<span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;salary&#39;</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">Float</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">create_all()</span></code> function uses the SQream engine object.</p>
</li>
<li><p>Create all the defined table objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Populate your table.</p>
<blockquote>
<div></div></blockquote>
</li>
<li><p>Build the data rows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">insert_data</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Richard&#39;</span><span class="p">,</span><span class="s1">&#39;lastname&#39;</span><span class="p">:</span> <span class="s1">&#39;Hendricks&#39;</span><span class="p">,</span>   <span class="s1">&#39;salary&#39;</span><span class="p">:</span> <span class="mf">12000.75</span><span class="p">}</span>
               <span class="p">,{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Bertram&#39;</span><span class="p">,</span> <span class="s1">&#39;lastname&#39;</span><span class="p">:</span> <span class="s1">&#39;Gilfoyle&#39;</span><span class="p">,</span> <span class="s1">&#39;salary&#39;</span><span class="p">:</span> <span class="mf">8400.0</span><span class="p">}</span>
               <span class="p">,{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>  <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Donald&#39;</span><span class="p">,</span> <span class="s1">&#39;lastname&#39;</span><span class="p">:</span> <span class="s1">&#39;Dunn&#39;</span><span class="p">,</span> <span class="s1">&#39;salary&#39;</span><span class="p">:</span> <span class="mf">6500.40</span><span class="p">}</span>
              <span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Build the <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ins</span> <span class="o">=</span> <span class="n">employees</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">insert_data</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Execute the command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ins</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<p>For more information, see the <span class="xref std std-ref">python_api_reference_guide</span>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 SQream.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>