.. _describe_query:

*****************
DESCRIBE QUERY
*****************
The ``DESCRIBE QUERY`` command replaces the `SHOW_NODE_INFO <https://docs.sqream.com/en/latest/reference/sql/sql_functions/system_functions/show_node_info.html>`_ command. You can use it to display information about query execution for monitoring and troubleshooting purposes.

Syntax
==========
The following is the syntax for the ``DESCRIBE QUERY`` command:

.. code-block:: postgres

   DESCRIBE QUERY [SESSION ID <session-id>] QUERY ID <query-id>;
   
Parameters
============
The following parameters can be used when switching databases with the **DESCRIBE QUERY** command:

.. list-table:: 
   :widths: auto
   :header-rows: 1
   
   * - Parameter Name
     - Parameter Value
     - Description
     - Type
   * - ``SESSION ID``
     - ``session_id``
     - (Optional) The session ID of the query. If not supplied current session ID is used.
     - Int
   * - ``QUERY ID``
     - ``query-id``
     - The query ID of the user.
     - Text
	 
	 
Output
=============
Using the ``DESCRIBE QUERY`` command generates the following output:

.. list-table:: 
   :widths: auto
   :header-rows: 1
   
   * - Parameter
     - Description
     - Type
     - Example
   * - ``query_id``
     - Displays the ID of the query.
     - Text
     - b6173e04-6e2a-4266-bef0-6fc9b8ffc097:3
   * - ``node_id``
     - Displays the ID of the node.
     - Integer
     - 1
   * - ``parent_id``
     - Displays the ID of the parent.
     - Integer
     - -1
   * - ``node_type``
     - Displays the node type.
     - Text
     - ParallelReadMetadata	 
   * - ``elapsed_time``
     - Displays the elapsed query time.
     - Integer
     - 0	 	 
   * - ``total_compute_time``
     - Displays the query's total compute time.
     - Integer
     - 0
   * - ``total_waiting_time``
     - Displays the query's total waiting time.
     - Integer
     - 0	 
   * - ``rows_produced``
     - Displays the amount of rows produced by the query.
     - Integer
     - 0
   * - ``chunks_produced``
     - Displays the amount of chunks produced by the query.
     - Integer
     - 0		 
   * - ``data_read``
     - Displays the amount of data read by the query.
     - Integer
     - 0
   * - ``data_written``
     - Displays the amount of data written by the query.
     - Integer
     - 0
   * - ``output``
     - Displays the query output.
     - Integer
     - 0
   * - ``additional_info``
     - Displays additional information.
     - Text
     - public.t1
	 
Example
==============
The following is an example of the ``DESCRIBE QUERY`` command:

.. code-block:: postgres

   DESCRIBE QUERY SESSION ID '9a034b00-bbfc-4c5f-8e84-bdddc057e9fe' QUERY ID '31';
   
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| query_id                                 | rtc_name                          | node_id  | parent_id  | node_type       | elapsed_time  | total_compute_time  | total_waiting_time  | rows_produced  | chunks_pro   |
+==========================================+===================================+==========+============+=================+===============+=====================+=====================+================+==============+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-b84w8  | 1        | -1         | CloudRSend      | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-tvlr2  | 1        | -1         | CloudRSend      | 0.333333333   | 0.333333333         | 0                   | 2              | 1            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-2gl57  | 1        | -1         | CloudRSend      | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-b84w8  | 2        | 1          | Rechunk         | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-2gl57  | 2        | 1          | Rechunk         | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-tvlr2  | 2        | 1          | Rechunk         | 0.000029654   | 0.000029654         | 0                   | 2              | 1            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-b84w8  | 3        | 2          | ReorderInput    | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-2gl57  | 3        | 2          | ReorderInput    | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-tvlr2  | 3        | 2          | ReorderInput    | 0.000011447   | 0.000011447         | 0                   | 2              | 1            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-b84w8  | 4        | 3          | DeferredGather  | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-2gl57  | 4        | 3          | DeferredGather  | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-tvlr2  | 4        | 3          | DeferredGather  | 0.000211682   | 0.000211682         | 0                   | 2              | 1            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-tvlr2  | 5        | 4          | ReorderInput    | 0.000011207   | 0.000011207         | 0                   | 2              | 1            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-b84w8  | 5        | 4          | ReorderInput    | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-2gl57  | 5        | 4          | ReorderInput    | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-b84w8  | 6        | 5          | GpuToCpu        | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-tvlr2  | 6        | 5          | GpuToCpu        | 0.000025727   | 0.000025727         | 0                   | 2              | 1            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-2gl57  | 6        | 5          | GpuToCpu        | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+
| 9a034b00-bbfc-4c5f-8e84-bdddc057e9fe:31  | sqream-worker-0-84576489c4-b84w8  | 7        | 6          | ReorderInput    | 0             | 0                   | 0                   | 0              | 0            |
+------------------------------------------+-----------------------------------+----------+------------+-----------------+---------------+---------------------+---------------------+----------------+--------------+


Permissions
=============
A user may execute ``DESCRIBE SESSION QUERIES`` on his sessions.

``SUPERUSER`` may execute ``DESCRIBE SESSION QUERIES`` on any session.